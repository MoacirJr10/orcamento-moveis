<div class="container">
  <div class="page-header">
    <h1>{{ modoEdicao ? 'Editar Orçamento' : 'Novo Orçamento' }}</h1>
    <div class="actions-right">
      <button type="button" class="btn-secondary" (click)="cancelar()">
        <i class="icon-arrow-left"></i> Voltar
      </button>
    </div>
  </div>

  <div *ngIf="mensagem" class="alert" [ngClass]="'alert-' + tipoMensagem">
    <span class="alert-icon" *ngIf="tipoMensagem === 'sucesso'">✓</span>
    <span class="alert-icon" *ngIf="tipoMensagem === 'erro'">✗</span>
    <span class="alert-icon" *ngIf="tipoMensagem === 'info'">ℹ</span>
    {{ mensagem }}
    <button class="close-btn" (click)="mensagem = ''">×</button>
  </div>

  <div class="loading-overlay" *ngIf="carregando">
    <div class="spinner"></div>
    <p>Processando...</p>
  </div>

  <form [formGroup]="orcamentoForm" (ngSubmit)="salvar()" *ngIf="!carregando" class="orcamento-form">
    <div class="card">
      <div class="card-header">
        <h2>Informações Gerais</h2>
      </div>
      <div class="card-body">
        <div class="form-row">
          <div class="form-group col-md-7">
            <label for="nomeCliente">Nome do Cliente *</label>
            <input
              id="nomeCliente"
              type="text"
              formControlName="nomeCliente"
              [ngClass]="{'invalid': orcamentoForm.get('nomeCliente')?.invalid && orcamentoForm.get('nomeCliente')?.touched}"
              placeholder="Nome completo do cliente"
            >
            <div *ngIf="obterMensagemErro('nomeCliente')" class="error-message">
              {{ obterMensagemErro('nomeCliente') }}
            </div>
          </div>

          <div class="form-group col-md-5">
            <label for="data">Data *</label>
            <input
              id="data"
              type="date"
              formControlName="data"
              [ngClass]="{'invalid': orcamentoForm.get('data')?.invalid && orcamentoForm.get('data')?.touched}"
            >
            <div *ngIf="obterMensagemErro('data')" class="error-message">
              {{ obterMensagemErro('data') }}
            </div>
          </div>
        </div>

        <div formGroupName="contato">
          <h3>Informações de Contato</h3>
          <div class="form-row">
            <div class="form-group col-md-4">
              <label for="telefone">Telefone</label>
              <input
                id="telefone"
                type="tel"
                formControlName="telefone"
                placeholder="(XX) XXXXX-XXXX"
              >
            </div>

            <div class="form-group col-md-4">
              <label for="email">Email</label>
              <input
                id="email"
                type="email"
                formControlName="email"
                placeholder="email@exemplo.com"
                [ngClass]="{'invalid': orcamentoForm.get('contato.email')?.invalid && orcamentoForm.get('contato.email')?.touched}"
              >
              <div *ngIf="obterMensagemErro('email', orcamentoForm.get('contato') as FormGroup)" class="error-message">
                {{ obterMensagemErro('email', orcamentoForm.get('contato') as FormGroup) }}
              </div>
            </div>

            <div class="form-group col-md-4">
              <label for="endereco">Endereço</label>
              <input
                id="endereco"
                type="text"
                formControlName="endereco"
                placeholder="Endereço do cliente"
              >
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group col-md-4">
            <label for="status">Status *</label>
            <select
              id="status"
              formControl
